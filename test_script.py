from os.path import dirname, join
import tensorflow as tf
import pickle
from tensorflow.keras.preprocessing.sequence import pad_sequences
def process_inputs(df):
    texts = [df]
    filename = join(dirname(__file__), "tokenizer.pickle")
    with open(filename, 'rb') as handle:
          tokenizer = pickle.load(handle)
    texts = tokenizer.texts_to_sequences(texts)
    processed_string = pad_sequences(texts, maxlen=859, padding='post')

    model_IE = tf.keras.models.load_model(join(dirname(__file__), "IE_model.h5"))
    model_NS = tf.keras.models.load_model(join(dirname(__file__), "NS_model.h5")
    model_FT = tf.keras.models.load_model(join(dirname(__file__), "FT_model.h5")
    model_JP = tf.keras.models.load_model(join(dirname(__file__), "JP_model.h5")

    result = model_IE.predict(processed_string)
    rr2 = tf.reshape(result, [4])
    rr = tf.dtypes.cast(rr2, tf.int32)
    if(rr[0]==1):
      IE = 'E'
    else:
      IE = 'I'
    if(rr[1]==1):
      NS = 'S'
    else:
      NS = 'N'
    if(rr[2]==1):
      FT = 'T'
    else:
      FT = 'F'
    if(rr[3]==1):
      JP = 'P'
    else:
      JP = 'J'
                                          
    return IE+NS+FT+JP

TestPosts = """'I think we do agree. I personally don't consider myself Alpha, Beta, or Foxtrot (lol at my own joke). People are people. We both agree that having emotions isn't the same as being weak, whiny,...|||Literature... I'd suggest 'Everyday Zen' by Charlotte Joko Beck. It's a solid introduction into mindfulness meditation, what it means to sit, etc. Ch'an Buddhism isn't exactly the same as Zen but...|||Being emotional doesn't automatically make someone not Alpha; every single human being, regardless of his or her type is emotional. We all feel things intensely. But emotions need to be kept in...|||I'm a Ch'an Buddhist, so it's a daily thing for me. Actually, it's an all-the-time thing for me. It has brought more clarity to my life, lowered my stress levels, and eliminated the fits that I'd...|||Glad to know I'm not the only one. I meditate, so I know what the thoughts/feelings are behind all this. I feel like, of all the women I've interacted with (and it's quite a few), she was the best...|||I've resolved this issue, but I appreciate everyone's input. I started taking Yoga classes and I lowered my standards a bit so that what I once called acquaintances are now friends. I still don't...|||I keep trying online dating on and off. I usually disable my account or delete it out of frustration because everyone I talk to just aren't what I'm looking for.  I tried it again a little more...|||Agree on all fronts. I don't understand how people can watch a baseball game, much less devote an entire conversation to it. Same goes for football, hockey, boxing (though I have to admit I love...|||Well, I tend to be kind of... over-confident, so negative feedback wouldn't devastate me; it would just give me a better idea of whether I'm too sure of myself or not.|||Financially, I'm in the 250k/yr+ group. Like you, I lead meetings (with clients mostly) and I'm very self-driven because, well, when you're self-employed, you have to be if you're going to be. You...|||When I'm upset, I usually can't help but show it. If it's someone I don't know well or someone who is particularly sensitive and who I don't want to hurt, I'll just be distant and quiet. Maybe say I...|||Just re-read your post. He's definitely interested if he wants to meet you after work for drinks. I'm definitely an Alpha (according to your description of alpha) and I'll tell you that I wouldn't...|||nevermind ;)|||I appreciated that you took the time to offer your opinion. It's just frustrating when people perceive me in a way that is totally opposite the truth. I'm open to friendship with everyone I encounter...|||I find commonalities in a lot of different types of people. I'm social and friendly with pretty much everyone I encounter (unless they're a total ass to me). But, something has to attract me to...|||I knew a guy that was homeless. He was one of the classiest people I knew. You guys are totally, completely misunderstanding where I'm coming from. It has nothing to do with money or superficial...|||Communicate with her, try to understand her, and, if nothing you do resolves the problem, leave. Don't totally cut her out of your life but don't let her have any power of yours. Parents can be just...|||I don't think I'm better; I think I'm different.|||I haven't had a friend since elementary school. In high school, I had acquaintances - likeminded people I got along with well enough but never did anything with after school. Same thing at previous...|||This morning, my mother was still criticizing me. But, when I came back from my 3 mile run half an hour later, I think I entered the twilight zone. She's back to her old happy and uncritical self. We...|||I've changed a lot in the last year. I went from preparing for the Priesthood to being an atheist, from loving hamburgers to being a vegetarian, from being pretty sedentary to being in the best shape...|||Dude, you are awesome! That girl is really lucky to have your attention because most guys (myself included) aren't as wise as you've been toward the whole situation. I'm a little ashamed to say it...|||Thanks for your input Pinion, OldManRivers. Yea, this definitely needs work. I think I'll take some creative writing classes at the college in town. This isn't terribly representative of how I'm...|||Hey CaptainMcMuffin, keep us posted about what you decide and how things turn out. And thanks for saying my post made you feel better. Knowing I helped someone makes me feel awesome.|||I'm the same way. There are times when I'm super social and times when I'm reclusive, and what I want out of any relationship (business, romantic, parent, sibling, etc.) changes depending on which...|||Haha! In any other context, that sounds horrible. Thanks thismustbetheplace.|||Thanks! Hell yea. I'd love a run-through if/whenever you feel up to it. This first chapter was written quite a while ago before I started writing (business copy) for a living, so grammar isn't a...|||The first part applies more in this case. I responded with the truth. I love myself and think I'm great and would be surprised if any *compatible* woman felt an attraction to me. Let me try to put...|||To be honest, I'm just looking for a way to rationalize running like hell from this whole thing. I'm not intimidated by her. It's just that seems so wonderful already and we haven't even started...|||It does absolutely make sense that you start to de-value something that you think you might not be able to get. It's what some kids do when they can't get something they want (and what I do when...|||I could've written that post. Seriously. Yea, I think you need to give it at least a bit more time. If she's smart and emotionally mature, she just wants to be sure she can trust you before she lets...|||Let's say you meet a great gal at a business meeting at a company you do work for. Let's say you give her your card and tell her you'd like to talk to her in a not-so-professional context. Let's say...|||I agree you shouldn't overthink things when you meet someone new and things just start moving in that direction but I don't necessarily think experiencing a relationship with someone who isn't who...|||Sounds like it really isn't all that serious for her. She's definitely *not* head over heels for you. We men have a tendency to think that a woman is hiding her feelings when, in reality, she may...|||I think distracting yourself from your thoughts and emotions is the best way to lift your spirits. For me, it has to be something productive. When I was depressed, I couldn't read novels and I...|||Now I know what to do if a woman kisses the palm of my hand! Haha. See, before this post, I would've thought she wanted a piece of liver. That's what my dog wants when he licks my hand. This new...|||Damn, you sound just like me. I can't seem to withhold a compliment from a woman I notice anything positive about. If she's got nice hair, I have to tell her. If she's got big, beautiful eyes, I'll...|||You guys are awesome! Acey, that's a good suggestion. My first novella, 'Missions of Peter Clark' was a Young Adult historical fiction piece. It was published in 2005 and it was in first person. I...|||FYI, I really don't like the restaurant scene but it's kind of important because George becomes a major player later in the book. That scene establishes George's character as wealthy, influential,...|||Fantastic input and advice, Alyosha! I can see the grandiosity you're talking about (George being super rich and the food being the best Fred had ever eaten) and I can also see the awkward pieces of...|||FYI, making oodles of money is over-rated. Seriously. It's only great when you're making all that money doing something you love to do - which you'd love doing even if you weren't getting paid to do...|||Come on... you're an INFP, so you've got to have some sort of artistic passion. If you love to write, do it for a living. If you love to play music, become a professional musician. If you love to...|||I know. I often spend half an hour in front of the mirror in the morning captivated by my reflection. I'm just so damn sexy! Hey, you didn't have to say that confidence had to be rooted in reality;...|||Haha, I guess Fred isn't a terribly common name in our generation. If you could suggest a name, I'd appreciate it. :)|||Could you read this (somewhat long) first chapter of a Sci-Fi novel I'm working on? I'm seriously thinking about going ahead and sending off the first three chapters to an agent I've worked with in...|||Haha, go for it! Online dating sucks, though, and some guy was just killed in my area by meeting a woman he met online. She picked him up at the mall for their date. Turns out her husband was hiding...|||Yea, I've had that too, where you develop an attraction to someone who you weren't initially attracted to. I don't mean 'love at first sight'; really, I think it's just the subconscious projecting...|||You know what sucks? I'm an introvert. While I'm actually extremely outgoing when I'm out and about in the world (talking to strangers in the line at the grocery store, buying a coffee for the old...|||I don't know if I'm the typical guy but if a woman complimented me, kissed my hand, painted me in the buff, or any of the other things you described, I'd love it - if I liked her. Now, quite a few...|||OMG! You're pushing 35! You're an old fart now. Could you sense the sarcasm there? Old is a 90 year old who had the misfortune of developing dementia. For someone with all of their mental...'"""
print(process_inputs(TestPosts))
